SELECT Mes, IFNULL(medncg.Total,0) as abertas, IFNULL(mednov.Total,0) as Nova, IFNULL(medconc.Total,0) as Concluida FROM periodo_ano

-- calculo de medidas abertas p mes

LEFT JOIN
(SELECT Mes as M, IFNULL(COUNT(id),0) as Total FROM periodo_ano AS perano

  LEFT JOIN
  (SELECT * FROM pb1_medidas) AS mednco
  ON 
  ((mednco.status_sis not like '%msuc%' and mednco.datanota <= perano.Ultdia)
  OR
   (mednco.status_sis like '%msuc%' and mednco.datanota <= perano.Ultdia and mednco.dataconc > perano.Ultdia))

  GROUP BY M) AS medncg
ON periodo_ano.Mes = medncg.M


-- Calculo de medidas novas p mes

LEFT JOIN 
(SELECT strftime('%Y-%m',datanota) As M, COUNT(ID) AS Total FROM pb1_medidas 
 GROUP BY M) AS mednov
ON periodo_ano.Mes = mednov.M


-- calculo de medidas concluidas p mes

LEFT JOIN
(SELECT strftime('%Y-%m',dataconc) As M, COUNT(ID) AS Total FROM pb1_medidas 
 WHERE
 status_sis like '%msuc%'
 GROUP BY M) AS medconc
ON periodo_ano.Mes = medconc.M
